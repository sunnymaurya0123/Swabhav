<!DOCTYPE html>
<html>
    <head>
        <title>
            Question Bank 2
        </title>
        <script src="jquery.js"></script>
    </head>
    <body>
        <div id="questions" style="visibility: visible">
            <h1>Welcome to Quiz Game!!!</h1>
            <p id="totalquestions"></p>
            <p>Id: <span id="questionid"></span> </p>
            <p id="q"></p>
            <form>
                <input id="radio0" type="radio" style="vertical-align: auto" name="options" onclick="storeValueOnRadioClick(this.value); "><span id="q0"></span><br>
                <input id="radio1" type="radio" style="vertical-align: auto" name="options" onclick="storeValueOnRadioClick(this.value); "><span id="q1"></span><br>
                <input id="radio2" type="radio" style="vertical-align: auto" name="options" onclick="storeValueOnRadioClick(this.value); "><span id="q2"></span><br>
                <input id="radio3" type="radio" style="vertical-align: auto" name="options" onclick="storeValueOnRadioClick(this.value); "><span id="q3"></span><br>
            </form>
            <button id="previousbutton">
                Previous
            </button>
            <button id="nextbutton">
                Next
            </button>
            <button id="finishbutton">
                Finish
            </button>
        </div>

        <div style="visibility: hidden" id="scores">
            <h1>Scores</h1>
            <p><span id="answers0"></span> </p>
            <p><span id="answers1"></span> </p>
            <p><span id="answers2"></span> </p>
            <p><span id="answers3"></span> </p>
            <p><span id="answers4"></span> </p>
            <p><span id="correctanswer"></span> </p>
            <p><span id="wronganswer"></span> </p>
            <p><span id="notselected"></span> </p>
            <canvas id="myCanvas" style="align-content: center"></canvas>
        </div>
        
        <script>
            var questionCounter=0
            var correctAnswer=0
            var wrongAnswer=0
            var nacounter=0
            var userAnswers=[]
            var radiovalue=$("#options")
            var previousbutton=$("#previousbutton")
            var nextbutton=$("#nextbutton")
            var finishbutton=$("#finishbutton")
            var questiontext=$("#q")
            var totalquestions=$("#totalquestions")
            finishbutton.hide()
            var questions=[
                {
                    id:1,
                    text:'Who is the PM of India?',
                    option:["Jawaharlal Nehru","Abdul Kalam","Indira Gandhi","Narendra Modi" ],
                    answer: "Narendra Modi"
                },
                {
                    id:2,
                    text:'When did the Chandrayan 2s lander lost its connection?',
                    option:["22th July 2019","23rd July 2019","2nd September 2019","2nd September 2018"],
                    answer: "2nd September 2019"
                },
                {
                    id:3,
                    text:'Who developed Yahoo?',
                    option:["David Filo and Jerry Yang","Dennis Ritchie and Ken Thompson", "Vint Cerf and Robert Kahn","Steve Case and Jeff Bezos"],
                    answer: "David Filo and Jerry Yang"
                },
                {
                    id:4,
                    text:'Who is the owner of super 30?',
                    option:["Hritik roshan","Arun Kumar","Anand Kumar","Pranav Kumar"],
                    answer:"Anand Kumar"
                },
                {
                    id:5,
                    text:'The setTimeout() belongs to which object?',
                    option:["Element","Window","Location","None"],
                    answer: "Window"
                }
            ]
            for(var i=0;i<questions.length;i++)
                userAnswers.push("NA")
            var questionid=$("#questionid")
            previousbutton.prop("disabled",true)
            previousbutton.click(()=>{
                showPrevQuestions()
            })
            nextbutton.click(()=>{
                showQuestions()
		        saveState()
                previousbutton.prop("disabled",false)
            })
            finishbutton.click(()=>{
                setResultVisibility()
                printUserAnswers()
                increementAnswerCount()
                printCounters()
                // drawPieChart() 
            })
            function showQuestions(){
                // console.log(questions[questionCounter].id)
                if(questionCounter==questions.length-1)
                    enableFinishButton()
                questionid.html(questions[questionCounter].id)
                uncheckRadioValue()
                totalquestions.html((questionCounter+1)+"/"+questions.length)
                if(questionCounter<questions.length){
                    questiontext.html(questions[questionCounter].text)
                for(var i=0;i<questions[questionCounter].option.length ;i++){
                    $(`#q${i}`).html(questions[questionCounter].option[i])
                    $(`#radio${i}`).val(questions[questionCounter].option[i])
                }
                    questionCounter++
                }
            }
            function showPrevQuestions(){
                questionCounter-=2
                questionid.html(questions[questionCounter].id)
                enableFinishButton()
                totalquestions.html((questionCounter+1)+"/"+questions.length)
                if(questionCounter<questions.length){
                    questiontext.html(questions[questionCounter].text)
                for(var i=0;i<questions[questionCounter].option.length ;i++){
                    $(`#q${i}`).html(questions[questionCounter].option[i])
                    $(`#radio${i}`).val(questions[questionCounter].option[i])
                }
                    questionCounter++
                }    
                if(questionCounter==1)
                    previousbutton.prop("disabled",true)
		        saveState()
            }
           function setResultVisibility(){
                    $("#questions").html("")
                    $("#scores").css("visibility","visible")
           }
            function enableFinishButton(){
                if(questionCounter==questions.length-1){
                    console.log("hh")
                    finishbutton.show()
                    nextbutton.hide()
                }
                if(questionCounter<questions.length-1){
                    console.log("hhh")
                    finishbutton.hide()
                    nextbutton.show()
                }
            }

            function saveState(){
                for(var i=0;i<radiovalue.length;i++){
                var optionselected=$(`#q${i}`).innerHTML
                if(userAnswers[questionid.html()-1]!="NA"){
                if(userAnswers[questionid.html()-1]==optionselected){
                    console.log(questionid.html()-1)
                    radiovalue[i].attr('checked', true)
                }
		}
		else
		    radiovalue[i].attr('unchecked', true)						
                }
            }
                function storeValueOnRadioClick(value){
                     console.log(userAnswers[questionid.html()-1])
                    
                    delete userAnswers[questionid.html()-1]
                    userAnswers[questionid.html()-1]=value
                    
                     console.log(userAnswers[questionid.html()-1])
		     console.log(userAnswers)
                }

            function printUserAnswers(){
                for(var i=0;i<userAnswers.length;i++)
                $(`#answers${i}`).html(userAnswers[i])
            }
            function increementAnswerCount(){
                for(var i=0;i<userAnswers.length;i++)
                if(userAnswers[i]==questions[i].answer)
                   correctAnswer++
                for(var i=0;i<questions.length;i++)
                    if(userAnswers[i]=='NA')
                        nacounter++  
            }
            function printCounters(){
                $("#correctanswer").html("Correct Answers: "+correctAnswer)
                wrongAnswer=questions.length-correctAnswer-nacounter
                $("#wronganswer").html("Wrong Answers: "+wrongAnswer)
                $("#notselected").html("Not Selected: "+nacounter)
                console.log(questions.length)
            }
            function uncheckRadioValue(){
                var optionelement=$("#options")
                for(var i=0;i<optionelement.length;i++)
                optionelement[i].attr('checked', true)
            }
            showQuestions();
        //     function drawPieChart(){
        //         var array=[correctAnswer,wrongAnswer,nacounter]
                
        //     var canvas=document.getElementById("myCanvas")
        //         canvas.width=500
        //         canvas.height=400
        //     var dimension=canvas.getContext("2d")
        //     var start_angle=0
        //     var totalvalue=correctAnswer+wrongAnswer+nacounter
        //     function drawPieSlice(dimension,centerX, centerY, radius, startAngle, endAngle, color ){
                
        //         for(var i=0;i<array.length;i++){
        //             dimension.fillStyle = color
        //             dimension.beginPath()
        //             dimension.moveTo(centerX,centerY)
        //             dimension.arc(centerX, centerY, radius, startAngle, endAngle)
        //             dimension.closePath()
        //             dimension.fill()
        //             val=array[i]
        //             slice_angle = 2 * Math.PI * val / totalvalue;
        //             var pieRadius = Math.min(canvas.width/2,canvas.height/2);
        //             var labelX = canvas.width/2 + (pieRadius / 2) * Math.cos(start_angle + slice_angle/2);
        //             var labelY = canvas.height/2 + (pieRadius / 2) * Math.sin(start_angle + slice_angle/2);

        //             var labelText = Math.round(100 * val / totalvalue);
        //             dimension.fillStyle = "black";
        //             dimension.font = "bold 20px Arial";
        //             dimension.fillText(labelText+"%", labelX,labelY);
        //             start_angle += slice_angle;
        //         }   
        //     }
        //     drawPieSlice(dimension, 250,250,150, 0, 2*(correctAnswer/questions.length)*Math.PI, 'green')
        //     drawPieSlice(dimension, 250,250,150, 2*(correctAnswer/questions.length)*Math.PI, 2*(correctAnswer/questions.length)*Math.PI+2*(wrongAnswer/questions.length)*Math.PI, 'red')
        //     drawPieSlice(dimension, 250,250,150, 2*(correctAnswer/questions.length)*Math.PI+2*(wrongAnswer/questions.length)*Math.PI, 2*(correctAnswer/questions.length)*Math.PI+2*(wrongAnswer/questions.length)*Math.PI+2*(nacounter/questions.length)*Math.PI, 'yellow')         
        // }
        </script>
    </body>
</html>